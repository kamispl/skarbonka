<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<!-- iOS: pe≈Çny ekran -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Skarbonka">
<link rel="apple-touch-icon" href="icon-192.png">

<!-- Android/PWA manifest -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4caf50">

<title>Skarbonka</title>

<style>
  /* Tw√≥j oryginalny CSS */
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    max-width: 520px;
    margin: auto;
    padding: 20px;
    background: #f0f0f5;
    color: #222;
  }

  h1 {
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    font-size: 2rem;
  }

  .header-icon {
    font-size: 2.2rem;
  }


  h2 {
    margin-top: 32px;
    font-weight: 700;
    font-size: 1.4rem;
    border-bottom: 2px solid #4caf50;
    padding-bottom: 4px;
  }

  #mainView input[type="text"],
  #mainView input[type="number"] {
    width: 100%;
    padding: 12px 14px;
    margin-top: 8px;
    margin-bottom: 12px;
    border-radius: 12px;
    border: 1.8px solid #bbb;
    font-size: 1.1rem;
    box-sizing: border-box;
    transition: border-color 0.3s;
  }

  #mainView input[type="text"]:focus,
  #mainView input[type="number"]:focus {
    border-color: #4caf50;
    outline: none;
  }

  .goal {
    background: white;
    padding: 16px 20px;
    margin: 10px 0;
    border-radius: 18px;
    box-shadow: 0 2px 7px rgb(0 0 0 / 0.1);
    cursor: pointer;
    transition: background 0.2s;
  }
  .goal:hover {
    background: #e0f2e9;
  }

  .progress {
    height: 24px;
    background: #ddd;
    border-radius: 20px;
    overflow: hidden;
    margin-top: 8px;
  }

  .progress-bar {
    height: 100%;
    background: #4caf50;
    width: 0%;
    transition: width 0.3s ease;
  }

  button {
    padding: 12px 18px;
    margin: 6px 6px 6px 0;
    border: none;
    border-radius: 14px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 600;
    min-width: 72px;
    box-shadow: 0 2px 5px rgb(0 0 0 / 0.12);
    transition: background-color 0.3s, transform 0.15s;
  }

  button:hover {
    transform: scale(1.06);
  }

  .btn-green {
    background: #4caf50;
    color: white;
  }

  .btn-red {
    background: #f44336;
    color: white;
  }

  .btn-blue {
    background: #2196f3;
    color: white;
  }

  .section-title {
    font-weight: 700;
    margin-top: 20px;
    margin-bottom: 6px;
    font-size: 1.2rem;
    color: #333;
  }

  .empty-text {
    text-align: center;
    color: #888;
    padding: 14px 0;
    font-size: 1.1rem;
    font-style: italic;
  }

  #detailView {
    margin-top: 12px;
  }

  #goalTitle {
    font-size: 1.8rem;
    margin-bottom: 8px;
  }

  #statusText {
    font-size: 1.1rem;
    margin-top: 6px;
  }

  .btn-group {
    margin-bottom: 10px;
  }

  /* Styl przycisku trybu ciemnego */
  .dark-mode-toggle {
    position: fixed;
    top: 10px;
    right: 10px;
    padding: 8px 12px;
    background: #444;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.9rem;
    z-index: 1000;
  }

  /* Styl trybu ciemnego */
  body.dark-mode {
    background: #1c1c1c;
    color: #ddd;
  }

  body.dark-mode .goal {
    background: #2a2a2a;
    box-shadow: 0 2px 7px rgba(255, 255, 255, 0.05);
  }

  body.dark-mode h2 {
    border-bottom-color: #81c784;
  }

  body.dark-mode .btn-green {
    background: #388e3c;
  }

  body.dark-mode .btn-red {
    background: #d32f2f;
  }

  body.dark-mode .btn-blue {
    background: #1976d2;
  }

  body.dark-mode .progress {
    background: #555;
  }


  body.dark-mode .section-title {
    color: #fff; /* bia≈Çy tekst dla tytu≈Ç√≥w sekcji */
  }

</style>
</head>
<body>

<h1>
  <span class="header-icon" aria-label="Skarbonka">üê∑</span>
  Skarbonka
  <span class="header-icon" aria-label="Monety">üí∞</span>
</h1>

<button class="dark-mode-toggle" onclick="toggleDarkMode()">üåô Tryb ciemny</button>

<div id="mainView">
  <h2>Twoje cele</h2>
  <div id="goalsList"></div>

  <h2>Uko≈Ñczone cele</h2>
  <div id="completedGoals"></div>

  <h2>Dodaj nowy cel</h2>
  <input id="goalName" type="text" placeholder="Nazwa celu" />
  <input id="goalAmount" type="number" min="0.01" step="0.01" placeholder="Kwota (z≈Ç)" />
  <button class="btn-green" onclick="addGoal()">Dodaj cel</button>
</div>

<div id="detailView" style="display:none;">
  <button class="btn-blue" onclick="backToMain()">‚¨Ö Powr√≥t</button>
  <h2 id="goalTitle"></h2>
  <div class="progress"><div class="progress-bar" id="progressBar"></div></div>
  <p id="statusText"></p>

  <div class="section-title">Dodaj pieniƒÖdze</div>

  <div class="section-title" style="font-weight:600; font-size:1rem; margin-top:0;">Grosze</div>
  <div id="coinsAdd" class="btn-group"></div>

  <div class="section-title" style="font-weight:600; font-size:1rem; margin-top:12px;">Z≈Çot√≥wki</div>
  <div id="notesAdd" class="btn-group"></div>

  <div class="section-title" style="margin-top: 28px;">Odejmij pieniƒÖdze</div>

  <div class="section-title" style="font-weight:600; font-size:1rem; margin-top:0;">Grosze</div>
  <div id="coinsSub" class="btn-group"></div>

  <div class="section-title" style="font-weight:600; font-size:1rem; margin-top:12px;">Z≈Çot√≥wki</div>
  <div id="notesSub" class="btn-group"></div>

  <div class="section-title" style="margin-top: 28px;">Inna kwota</div>
  <button class="btn-green" onclick="customAdd()">Dodaj w≈ÇasnƒÖ kwotƒô</button>
  <button class="btn-red" onclick="customSubtract()">Odejmij w≈ÇasnƒÖ kwotƒô</button>

  <div class="section-title" style="margin-top: 28px;">ZarzƒÖdzanie celem</div>
  <button class="btn-blue" onclick="editGoal()">‚úèÔ∏è Edytuj cel</button>
  <button class="btn-red" onclick="deleteGoal()">üóëÔ∏è Usu≈Ñ cel</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js">
  
  // Tryb ciemny - ≈Çadowanie ustawienia
  const darkModeToggleBtn = document.querySelector('.dark-mode-toggle');

  function updateDarkModeButton() {
    if (document.body.classList.contains("dark-mode")) {
      darkModeToggleBtn.textContent = "‚òÄÔ∏è Tryb jasny";
    } else {
      darkModeToggleBtn.textContent = "üåô Tryb ciemny";
    }
  }

  if (localStorage.getItem("darkMode") === "true") {
    document.body.classList.add("dark-mode");
  }
  updateDarkModeButton();

  function toggleDarkMode() {
    document.body.classList.toggle("dark-mode");
    localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
    updateDarkModeButton();
  }

</script>
<script>
  /* Tw√≥j oryginalny JS */
  let goals = JSON.parse(localStorage.getItem('goals')) || [];
  let currentGoalIndex = null;

  const coinValues = [0.01, 0.02, 0.05, 0.10, 0.20, 0.50];
  const noteValues = [1, 2, 5, 10, 20, 50, 100, 200, 500];

  function saveGoals() {
    localStorage.setItem('goals', JSON.stringify(goals));
  }

  function renderGoals() {
    const list = document.getElementById('goalsList');
    const completedList = document.getElementById('completedGoals');
    list.innerHTML = '';
    completedList.innerHTML = '';

    const activeGoals = goals.filter(g => g.saved < g.amount);
    const doneGoals = goals.filter(g => g.saved >= g.amount);

    if (activeGoals.length === 0)
      list.innerHTML = `<div class="empty-text">Brak cel√≥w</div>`;
    if (doneGoals.length === 0)
      completedList.innerHTML = `<div class="empty-text">Brak uko≈Ñczonych cel√≥w</div>`;

    activeGoals.forEach(g => {
      let index = goals.indexOf(g);
      let percent = g.amount > 0 ? (g.saved / g.amount) * 100 : 0;
      const div = document.createElement('div');
      div.className = 'goal';
      div.innerHTML = `<strong>${g.name}</strong><br>${g.saved.toFixed(2)} z≈Ç / ${g.amount.toFixed(2)} z≈Ç
        <div class="progress"><div class="progress-bar" style="width:${percent}%;"></div></div>`;
      div.onclick = () => openGoal(index);
      list.appendChild(div);
    });

    doneGoals.forEach(g => {
      let index = goals.indexOf(g);
      const div = document.createElement('div');
      div.className = 'goal';
      div.innerHTML = `<strong>${g.name}</strong><br>Uzbierano: ${g.amount.toFixed(2)} z≈Ç ‚úÖ`;
      div.onclick = () => openGoal(index);
      completedList.appendChild(div);
    });
  }

  function addGoal() {
    const name = document.getElementById('goalName').value.trim();
    const amount = parseFloat(document.getElementById('goalAmount').value);
    if (!name || isNaN(amount) || amount <= 0) return alert("Podaj poprawne dane");
    goals.push({ name, amount, saved: 0 });
    saveGoals();
    document.getElementById('goalName').value = '';
    document.getElementById('goalAmount').value = '';
    renderGoals();
  }

  function openGoal(index) {
    currentGoalIndex = index;
    document.getElementById('mainView').style.display = 'none';
    document.getElementById('detailView').style.display = 'block';
    updateDetailUI();
  }

  function backToMain() {
    document.getElementById('mainView').style.display = 'block';
    document.getElementById('detailView').style.display = 'none';
    renderGoals();
  }

  function updateDetailUI() {
    const g = goals[currentGoalIndex];
    document.getElementById('goalTitle').textContent = `Cel: ${g.name}`;
    let percent = g.amount > 0 ? (g.saved / g.amount) * 100 : 0;
    document.getElementById('progressBar').style.width = percent + '%';
    document.getElementById('statusText').textContent = `${g.saved.toFixed(2)} z≈Ç / ${g.amount.toFixed(2)} z≈Ç`;

    const coinsAdd = document.getElementById('coinsAdd');
    coinsAdd.innerHTML = '';
    coinValues.forEach(v => {
      let btn = document.createElement('button');
      btn.className = 'btn-green';
      btn.textContent = `+${(v * 100).toFixed(0)} gr`;
      btn.onclick = () => addMoney(v);
      coinsAdd.appendChild(btn);
    });

    const notesAdd = document.getElementById('notesAdd');
    notesAdd.innerHTML = '';
    noteValues.forEach(v => {
      let btn = document.createElement('button');
      btn.className = 'btn-green';
      btn.textContent = `+${v} z≈Ç`;
      btn.onclick = () => addMoney(v);
      notesAdd.appendChild(btn);
    });

    const coinsSub = document.getElementById('coinsSub');
    coinsSub.innerHTML = '';
    coinValues.forEach(v => {
      let btn = document.createElement('button');
      btn.className = 'btn-red';
      btn.textContent = `-${(v * 100).toFixed(0)} gr`;
      btn.onclick = () => subtractMoney(v);
      coinsSub.appendChild(btn);
    });

    const notesSub = document.getElementById('notesSub');
    notesSub.innerHTML = '';
    noteValues.forEach(v => {
      let btn = document.createElement('button');
      btn.className = 'btn-red';
      btn.textContent = `-${v} z≈Ç`;
      btn.onclick = () => subtractMoney(v);
      notesSub.appendChild(btn);
    });
  }

  function addMoney(amount) {
    const g = goals[currentGoalIndex];
    g.saved += amount;
    if (g.saved >= g.amount) {
      g.saved = g.amount;
      confetti({ particleCount: 150, spread: 100 });
    }
    saveGoals();
    updateDetailUI();
  }

  function subtractMoney(amount) {
    const g = goals[currentGoalIndex];
    g.saved -= amount;
    if (g.saved < 0) g.saved = 0;
    saveGoals();
    updateDetailUI();
  }

  function customAdd() {
    let amount = parseFloat(prompt("Podaj kwotƒô:"));
    if (!isNaN(amount) && amount > 0) addMoney(amount);
  }

  function customSubtract() {
    let amount = parseFloat(prompt("Podaj kwotƒô:"));
    if (!isNaN(amount) && amount > 0) subtractMoney(amount);
  }

  function deleteGoal() {
    if (confirm("Czy na pewno chcesz usunƒÖƒá ten cel?")) {
      goals.splice(currentGoalIndex, 1);
      saveGoals();
      backToMain();
    }
  }

  function editGoal() {
    let g = goals[currentGoalIndex];
    let newName = prompt("Nowa nazwa celu:", g.name);
    let newAmount = parseFloat(prompt("Nowa kwota celu:", g.amount));
    if (newName && !isNaN(newAmount) && newAmount > 0) {
      g.name = newName;
      g.amount = newAmount;
      if (g.saved > g.amount) g.saved = g.amount;
      saveGoals();
      updateDetailUI();
    }
  }

  renderGoals();

  // Rejestracja Service Workera
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js")
      .then(() => console.log("‚úÖ Service Worker dzia≈Ça"))
      .catch(err => console.error("‚ùå B≈ÇƒÖd SW:", err));
  }

  
  // Tryb ciemny - ≈Çadowanie ustawienia
  const darkModeToggleBtn = document.querySelector('.dark-mode-toggle');

  function updateDarkModeButton() {
    if (document.body.classList.contains("dark-mode")) {
      darkModeToggleBtn.textContent = "‚òÄÔ∏è Tryb jasny";
    } else {
      darkModeToggleBtn.textContent = "üåô Tryb ciemny";
    }
  }

  if (localStorage.getItem("darkMode") === "true") {
    document.body.classList.add("dark-mode");
  }
  updateDarkModeButton();

  function toggleDarkMode() {
    document.body.classList.toggle("dark-mode");
    localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
    updateDarkModeButton();
  }

</script>

<footer style="text-align: center; font-size: 0.75rem; color: #888; margin-top: 40px; padding: 10px 0;">
  by kamis
</footer>

</body>
</html>
